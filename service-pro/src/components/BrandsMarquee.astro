---
/**
 * BrandsMarquee: trae todos los archivos que empiecen con "logo"
 * desde /src/assets/images y arma un carrusel infinito.
 *
 * Nota: usamos query '?url' para garantizar string URLs.
 */

const modules = import.meta.glob("../assets/images/logo*.*", {
  eager: true,
  query: "?url",
  import: "default",
});

const logos = Object.values(modules)
  .filter((v): v is string => typeof v === "string" && v.length > 0)
  .sort((a, b) => a.localeCompare(b, "es"));

function niceAlt(src: string) {
  const file = src.split("/").pop() || "logo";
  const name = decodeURIComponent(file)
    .replace(/^logo\s*/i, "")
    .replace(/\.[a-z0-9]+$/i, "")
    .replace(/[-_]+/g, " ")
    .trim();
  return name ? `Logo ${name}` : "Logo de marca";
}
---
<section class="section section--tight" data-reveal>
  <div class="container">
    <h2 class="h2">Trabajamos con primeras marcas</h2>
    <p class="p">Repuestos y diagn√≥sticos con experiencia real en equipos de uso diario.</p>
  </div>

  <div class="marquee marquee--full" aria-label="Marcas con las que trabajamos">
    <div class="marquee__track">
      {[...logos, ...logos].map((src) => (
        <div class="brandLogo">
          <img src={src} alt={niceAlt(src)} loading="lazy" decoding="async" />
        </div>
      ))}
    </div>
  </div>
</section>
